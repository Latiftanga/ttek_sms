{% load core_tags %}

<div class="card-body p-4">
    {% if documents %}
    <div class="space-y-3">
        {% for doc in documents %}
        <div class="flex items-start gap-3 p-3 rounded-lg bg-base-200/50 hover:bg-base-200 transition-colors group">
            <div class="w-10 h-10 rounded-lg flex items-center justify-center shrink-0
                {% if doc.is_expired %}bg-error/10 text-error
                {% elif doc.is_expiring_soon %}bg-warning/10 text-warning
                {% elif doc.is_verified %}bg-success/10 text-success
                {% else %}bg-base-300 text-base-content/50{% endif %}">
                {% if doc.is_pdf %}<i class="fa-solid fa-file-pdf"></i>
                {% elif doc.is_image %}<i class="fa-solid fa-file-image"></i>
                {% else %}<i class="fa-solid fa-file"></i>{% endif %}
            </div>
            <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-2">
                    <div>
                        <div class="font-medium flex items-center gap-2">
                            {{ doc.title }}
                            {% if doc.is_verified %}
                            <span class="badge badge-success badge-xs">Verified</span>
                            {% else %}
                            <span class="badge badge-warning badge-xs">Pending</span>
                            {% endif %}
                        </div>
                        <div class="text-xs text-base-content/60 flex flex-wrap items-center gap-2 mt-0.5">
                            <span>{{ doc.get_document_type_display }}</span>
                            <span class="text-base-content/40">|</span>
                            <span>{{ doc.file_extension|upper }}</span>
                        </div>
                    </div>
                </div>
                <div class="flex flex-wrap items-center gap-3 mt-2 text-xs text-base-content/60">
                    {% if doc.issue_date %}
                    <span><i class="fa-regular fa-calendar mr-1"></i>Issued {{ doc.issue_date|date:"M Y" }}</span>
                    {% endif %}
                    {% if doc.expiry_date %}
                    <span class="{% if doc.is_expired %}text-error{% elif doc.is_expiring_soon %}text-warning{% endif %}">
                        <i class="fa-solid fa-hourglass-end mr-1"></i>{% if doc.is_expired %}Expired{% else %}Expires{% endif %} {{ doc.expiry_date|date:"M Y" }}
                    </span>
                    {% endif %}
                    <span><i class="fa-regular fa-clock mr-1"></i>{{ doc.created_at|date:"M d, Y" }}</span>
                </div>
            </div>
            <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
                <a href="{{ doc.file.url }}" target="_blank" class="btn btn-ghost btn-xs btn-square" title="View">
                    <i class="fa-solid fa-eye text-xs"></i>
                </a>
                <button class="btn btn-ghost btn-xs btn-square"
                        hx-get="{% url 'core:my_documents_edit' doc.pk %}"
                        hx-target="#modal-container"
                        onclick="modal_form.showModal()">
                    <i class="fa-solid fa-pen text-xs"></i>
                </button>
                <form hx-post="{% url 'core:my_documents_delete' doc.pk %}"
                      hx-target="#doc-content"
                      hx-swap="innerHTML"
                      hx-confirm="Delete '{{ doc.title }}'?">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-ghost btn-xs btn-square text-error">
                        <i class="fa-solid fa-trash text-xs"></i>
                    </button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12 text-base-content/50">
        <div class="w-20 h-20 rounded-full bg-base-200 flex items-center justify-center mx-auto mb-4">
            <i class="fa-solid fa-folder-open text-3xl"></i>
        </div>
        <h3 class="font-semibold text-lg mb-2">No Documents Yet</h3>
        <p class="text-sm mb-4">Upload your documents for easy access and management</p>
        <button class="btn btn-primary"
                hx-get="{% url 'core:my_documents_create' %}"
                hx-target="#modal-container"
                onclick="modal_form.showModal()">
            <i class="fa-solid fa-upload"></i>
            Upload First Document
        </button>
    </div>
    {% endif %}
</div>
