{% load core_tags %}

<h3 class="font-bold text-lg flex items-center gap-2 mb-4">
    <i class="fa-solid fa-key text-primary"></i>
    Change Password
</h3>

{% if form.errors %}
<div class="alert alert-error alert-sm mb-4">
    <i class="fa-solid fa-circle-exclamation"></i>
    <div class="text-sm">
        {% for field in form %}
            {% for error in field.errors %}
                <p>{{ field.label }}: {{ error }}</p>
            {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
            <p>{{ error }}</p>
        {% endfor %}
    </div>
</div>
{% endif %}

<form method="post"
      action="{% url 'accounts:password_change' %}"
      hx-post="{% url 'accounts:password_change' %}"
      hx-target="#password-change-container"
      hx-swap="innerHTML">
    {% csrf_token %}

    {% password_input "old_password" label="Current Password" placeholder="Enter current password" required=True error=form.old_password.errors.0 %}

    {% password_input "new_password1" label="New Password" placeholder="Enter new password" required=True error=form.new_password1.errors.0 %}

    {% password_input "new_password2" label="Confirm New Password" placeholder="Confirm new password" required=True error=form.new_password2.errors.0 %}

    <div class="bg-base-200 rounded-lg p-3 text-xs mt-4">
        <p class="font-medium mb-2">Password Requirements:</p>
        <ul class="text-base-content/70 space-y-1">
            <li class="flex items-center gap-2">
                <i class="fa-solid fa-check text-success text-[10px]"></i>
                At least 8 characters long
            </li>
            <li class="flex items-center gap-2">
                <i class="fa-solid fa-check text-success text-[10px]"></i>
                Not too similar to your personal information
            </li>
            <li class="flex items-center gap-2">
                <i class="fa-solid fa-check text-success text-[10px]"></i>
                Not a commonly used password
            </li>
        </ul>
    </div>

    <div class="modal-action">
        <button type="button" class="btn btn-ghost" onclick="modal_password_change.close()">Cancel</button>
        <button type="submit" class="btn btn-primary">
            <i class="fa-solid fa-shield-check"></i>
            Change Password
        </button>
    </div>
</form>
