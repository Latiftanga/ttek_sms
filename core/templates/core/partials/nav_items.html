{% comment %}
Reusable navigation items component using DaisyUI menu with details/summary.
Usage: {% include "core/partials/nav_items.html" with nav_items=nav_items is_mobile=True %}

Parameters:
- nav_items: List of navigation items from {% get_navigation_items %}
- is_mobile: Boolean to adjust styles and close drawer on mobile
{% endcomment %}

{% for item in nav_items %}
    {% if item.children %}
        {# Menu item with submenu - parent is clickable link, arrow toggles dropdown #}
        <li>
            <details {% if item.is_active %}open{% endif %}>
                <summary class="flex items-center">
                    <a href="{{ item.url }}"
                       hx-get="{{ item.url }}"
                       hx-target="#main-content"
                       hx-push-url="true"
                       hx-swap="innerHTML show:window:top"
                       preload="mouseover"
                       {% if is_mobile %}hx-on::after-request="if(event.detail.successful) document.getElementById('mobile-drawer').checked = false"{% endif %}
                       class="flex items-center gap-2 flex-1"
                       onclick="event.stopPropagation()">
                        <i class="{{ item.icon }} w-5 text-center"></i>
                        <span class="sidebar-text">{{ item.label }}</span>
                    </a>
                </summary>
                <ul>
                    {% for child in item.children %}
                        <li>
                            <a href="{{ child.url }}"
                               hx-get="{{ child.url }}"
                               hx-target="#main-content"
                               hx-push-url="true"
                               hx-swap="innerHTML show:window:top"
                               preload="mouseover"
                               {% if is_mobile %}hx-on::after-request="if(event.detail.successful) document.getElementById('mobile-drawer').checked = false"{% endif %}
                               class="{% if child.is_active %}active{% endif %}">
                                <i class="{{ child.icon }} w-4 text-center"></i>
                                <span class="sidebar-text">{{ child.label }}</span>
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </details>
        </li>
    {% else %}
        {# Simple menu item without submenu #}
        <li>
            <a href="{{ item.url }}"
               hx-get="{{ item.url }}"
               hx-target="#main-content"
               hx-push-url="true"
               hx-swap="innerHTML show:window:top"
               preload="mouseover"
               {% if is_mobile %}hx-on::after-request="if(event.detail.successful) document.getElementById('mobile-drawer').checked = false"{% endif %}
               class="{% if item.is_active %}active{% endif %}">
                <i class="{{ item.icon }} w-5 text-center"></i>
                <span class="sidebar-text">{{ item.label }}</span>
            </a>
        </li>
    {% endif %}
{% endfor %}
