{% load core_tags %}
<div class="drawer-side z-50 lg:hidden">
    <label for="mobile-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
    <aside class="sidebar-nav w-72 flex flex-col h-full shadow-lg">
        <!-- Logo area -->
        <div class="p-4 shrink-0 border-b border-white/10">
            <div class="flex items-center gap-3">
                {% if school.logo %}
                    <img src="{{ school.logo.url }}" alt="{{ school.display_name|default:school.name }}" class="w-9 h-9 rounded-lg object-contain bg-white/10 p-0.5" loading="lazy" />
                {% else %}
                    <div class="w-9 h-9 rounded-lg bg-white/15 grid place-content-center font-bold text-lg">
                        {{ school.short_name|slice:":1"|default:"S" }}
                    </div>
                {% endif %}
                <div class="flex flex-col">
                    <span class="font-bold text-base leading-tight">{{ school.short_name|default:"School" }}</span>
                    {% if school.motto %}
                    <span class="text-[10px] opacity-40 truncate max-w-[120px] leading-tight">{{ school.motto|truncatewords:3 }}</span>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Navigation menu -->
        <nav class="flex-1 overflow-y-auto overflow-x-hidden scrollbar-thin">
            <ul class="menu p-2 gap-0.5 text-sm" id="mobile-nav">
                {% get_navigation_items as nav_items %}
                {% include "core/partials/nav_items.html" with nav_items=nav_items is_mobile=True %}
            </ul>
        </nav>

        <!-- Settings (admin only) -->
        {% if user.is_superuser or user.is_school_admin %}
        <div class="p-2 border-t border-white/10 shrink-0">
            <ul class="menu p-0">
                <li>
                    <a href="{% url 'core:settings' %}"
                       hx-get="{% url 'core:settings' %}"
                       hx-target="#main-content"
                       hx-push-url="true"
                       hx-swap="innerHTML show:window:top"
                       hx-on::after-request="document.getElementById('mobile-drawer').checked = false">
                        <i class="fa-solid fa-gear w-5 text-center"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </div>
        {% endif %}
    </aside>
</div>
