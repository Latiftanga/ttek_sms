{% load core_tags %}

<div class="space-y-3">
    {% for cls in class_list %}
    <div class="p-3 rounded-lg bg-base-200/30 hover:bg-base-200/50 transition-colors">
        <div class="flex items-start gap-3">
            <!-- Level Badge -->
            <div class="w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0
                {% if cls.level_type == 'creche' %}bg-secondary/10 text-secondary
                {% elif cls.level_type == 'nursery' %}bg-accent/10 text-accent
                {% elif cls.level_type == 'kg' %}bg-info/10 text-info
                {% elif cls.level_type == 'basic' %}bg-success/10 text-success
                {% else %}bg-primary/10 text-primary{% endif %}">
                <span class="text-xs font-bold">{{ cls.level_number|default:"--" }}</span>
            </div>

            <!-- Info -->
            <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-2">
                    <div class="min-w-0">
                        <a href="{% url 'academics:class_detail' cls.pk %}"
                           hx-get="{% url 'academics:class_detail' cls.pk %}"
                           hx-target="#main-content"
                           hx-push-url="true"
                           class="font-semibold text-sm hover:text-primary transition-colors truncate block">
                            {{ cls.name }}
                        </a>
                        {% if tenant.has_programmes and cls.programme %}
                        <p class="text-xs text-base-content/50">{{ cls.programme.name }}</p>
                        {% endif %}
                    </div>
                    <span class="badge badge-xs flex-shrink-0
                        {% if cls.level_type == 'creche' %}badge-secondary
                        {% elif cls.level_type == 'nursery' %}badge-accent
                        {% elif cls.level_type == 'kg' %}badge-info
                        {% elif cls.level_type == 'basic' %}badge-success
                        {% else %}badge-primary{% endif %}">
                        {{ cls.get_level_type_display }}
                    </span>
                </div>

                <!-- Details -->
                <div class="mt-2 flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-base-content/70">
                    {% if cls.class_teacher %}
                    <span class="flex items-center gap-1">
                        <i class="fa-solid fa-user-tie w-3"></i>
                        {{ cls.class_teacher.get_title_display }} {{ cls.class_teacher.last_name }}
                    </span>
                    {% endif %}
                    <span class="flex items-center gap-2">
                        <i class="fa-solid fa-users w-3"></i>
                        <span class="font-medium">{{ cls.student_count }}/{{ cls.capacity }}</span>
                        <progress class="progress progress-primary h-1.5 w-12"
                                  value="{{ cls.student_count }}"
                                  max="{{ cls.capacity }}"></progress>
                    </span>
                    <span class="flex items-center gap-1" title="Attendance Type">
                        <i class="fa-solid fa-clipboard-check w-3"></i>
                        {% if cls.attendance_type == 'per_lesson' %}
                        <span class="badge badge-xs badge-secondary">Per-Lesson</span>
                        {% else %}
                        <span class="badge badge-xs badge-ghost">Daily</span>
                        {% endif %}
                    </span>
                </div>

                <!-- Actions -->
                <div class="mt-3 flex gap-2">
                    <a href="{% url 'academics:class_detail' cls.pk %}"
                       hx-get="{% url 'academics:class_detail' cls.pk %}"
                       hx-target="#main-content"
                       hx-push-url="true"
                       class="btn btn-ghost btn-xs flex-1">
                        <i class="fa-solid fa-eye"></i>
                        View
                    </a>
                    <button class="btn btn-ghost btn-xs flex-1"
                            hx-get="{% url 'academics:class_edit' cls.pk %}"
                            hx-target="#modal-class-edit-content"
                            hx-swap="innerHTML"
                            onclick="document.getElementById('modal_class_edit').showModal()">
                        <i class="fa-solid fa-pen"></i>
                        Edit
                    </button>
                    <form hx-post="{% url 'academics:class_delete' cls.pk %}"
                          hx-target="#classes-container"
                          hx-swap="outerHTML"
                          hx-confirm="Delete class {{ cls.name }}?"
                          class="flex-1">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-ghost btn-xs text-error w-full">
                            <i class="fa-solid fa-trash"></i>
                            Delete
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
