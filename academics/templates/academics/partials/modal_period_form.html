{% load core_tags %}

<h3 class="font-bold text-lg mb-4">
    <i class="fa-solid fa-clock text-primary"></i>
    {{ action }} Period
</h3>

<form hx-post="{% if period %}{% url 'academics:period_edit' period.pk %}{% else %}{% url 'academics:period_create' %}{% endif %}"
      hx-target="#modal-container"
      hx-swap="innerHTML"
      class="space-y-4">
    {% csrf_token %}

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Name -->
        <div class="form-control md:col-span-2">
            <label class="label">
                <span class="label-text font-medium">Period Name</span>
            </label>
            <input type="text" name="name"
                   value="{{ form.name.value|default:'' }}"
                   placeholder="e.g., Period 1, Break, Assembly"
                   class="input input-bordered w-full" required>
            {% if form.name.errors %}
            <label class="label"><span class="label-text-alt text-error">{{ form.name.errors.0 }}</span></label>
            {% endif %}
        </div>

        <!-- Start Time -->
        <div class="form-control">
            <label class="label">
                <span class="label-text font-medium">Start Time</span>
            </label>
            <input type="time" name="start_time"
                   value="{% if period %}{{ period.start_time|time:'H:i' }}{% elif form.start_time.value %}{{ form.start_time.value|time:'H:i' }}{% endif %}"
                   class="input input-bordered w-full" required>
            {% if form.start_time.errors %}
            <label class="label"><span class="label-text-alt text-error">{{ form.start_time.errors.0 }}</span></label>
            {% endif %}
        </div>

        <!-- End Time -->
        <div class="form-control">
            <label class="label">
                <span class="label-text font-medium">End Time</span>
            </label>
            <input type="time" name="end_time"
                   value="{% if period %}{{ period.end_time|time:'H:i' }}{% elif form.end_time.value %}{{ form.end_time.value|time:'H:i' }}{% endif %}"
                   class="input input-bordered w-full" required>
            {% if form.end_time.errors %}
            <label class="label"><span class="label-text-alt text-error">{{ form.end_time.errors.0 }}</span></label>
            {% endif %}
        </div>

        <!-- Order -->
        <div class="form-control">
            <label class="label">
                <span class="label-text font-medium">Display Order</span>
            </label>
            <input type="number" name="order"
                   value="{{ form.order.value|default:'0' }}"
                   min="0" max="20"
                   class="input input-bordered w-full">
            {% if form.order.errors %}
            <label class="label"><span class="label-text-alt text-error">{{ form.order.errors.0 }}</span></label>
            {% endif %}
        </div>

        <!-- Checkboxes -->
        <div class="form-control flex flex-col justify-end">
            <label class="label cursor-pointer justify-start gap-3">
                <input type="checkbox" name="is_break" class="checkbox checkbox-warning"
                       {% if form.is_break.value %}checked{% endif %}>
                <span class="label-text">Break Period</span>
            </label>
        </div>

        <!-- Is Active -->
        <div class="form-control md:col-span-2">
            <label class="label cursor-pointer justify-start gap-3">
                <input type="checkbox" name="is_active" class="checkbox checkbox-success"
                       {% if form.is_active.value or form.is_active.value == None %}checked{% endif %}>
                <span class="label-text">Active (visible in timetable)</span>
            </label>
        </div>
    </div>

    {% if form.non_field_errors %}
    <div class="alert alert-error">
        <i class="fa-solid fa-exclamation-circle"></i>
        <span>{{ form.non_field_errors.0 }}</span>
    </div>
    {% endif %}

    <div class="modal-action">
        <button type="button" class="btn btn-ghost" onclick="modal_form.close()">Cancel</button>
        <button type="submit" class="btn btn-primary">
            <i class="fa-solid fa-save"></i>
            {{ action }} Period
        </button>
    </div>
</form>
