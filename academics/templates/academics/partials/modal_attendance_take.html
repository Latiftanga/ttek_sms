{% load core_tags %}
<div class="flex justify-between items-center mb-4 sticky top-0 bg-base-100 z-10 pb-2 border-b border-base-200">
    <div>
        <h3 class="text-xl font-bold">{% if is_edit %}Edit Attendance{% else %}Mark Attendance{% endif %}</h3>
        <p class="text-xs text-base-content/60">{{ date|date:"l, F jS Y" }}</p>
    </div>
    <div class="badge badge-primary">{{ student_list|length }} Students</div>
</div>

<form method="post"
      {% if is_edit %}
      action="{% url 'academics:class_attendance_edit' class.pk session.pk %}"
      hx-post="{% url 'academics:class_attendance_edit' class.pk session.pk %}"
      {% else %}
      action="{% url 'academics:class_attendance_take' class.pk %}"
      hx-post="{% url 'academics:class_attendance_take' class.pk %}"
      {% endif %}
      hx-target="#modal-edit-content"
      hx-swap="innerHTML">
    {% csrf_token %}
    
    <div class="h-[50vh] overflow-y-auto pr-2 space-y-2">
        {% for item in student_list %}
        <div class="flex items-center justify-between p-3 border border-base-200 rounded-lg hover:bg-base-200/50">
            <div class="flex items-center gap-3">
                <div class="avatar placeholder">
                    <div class="w-8 h-8 rounded-full bg-base-300 flex items-center justify-center">
                        <span class="text-xs">{{ item.obj.first_name|slice:":1" }}{{ item.obj.last_name|slice:":1" }}</span>
                    </div>
                </div>
                <div>
                    <div class="font-bold text-sm">{{ item.obj.full_name }}</div>
                    <div class="text-xs opacity-50">{{ item.obj.admission_number }}</div>
                </div>
            </div>
            
            <div class="join">
                <input class="join-item btn btn-xs btn-success aria-checked:btn-active" 
                       type="radio" 
                       name="status_{{ item.obj.id }}" 
                       value="P" 
                       aria-label="P" 
                       {% if item.status == 'P' %}checked{% endif %} />
                       
                <input class="join-item btn btn-xs btn-warning aria-checked:btn-active" 
                       type="radio" 
                       name="status_{{ item.obj.id }}" 
                       value="L" 
                       aria-label="L" 
                       {% if item.status == 'L' %}checked{% endif %} />
                       
                <input class="join-item btn btn-xs btn-error aria-checked:btn-active" 
                       type="radio" 
                       name="status_{{ item.obj.id }}" 
                       value="A" 
                       aria-label="A" 
                       {% if item.status == 'A' %}checked{% endif %} />
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="modal-action border-t border-base-200 pt-4 mt-4">
        <button type="button" class="btn" onclick="modal_edit.close()">Cancel</button>
        <button type="submit" class="btn btn-primary px-8">Save Register</button>
    </div>
</form>