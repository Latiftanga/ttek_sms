<!-- Student Attendance Detail Modal Content -->
<div class="space-y-4">
    <!-- Student Header -->
    <div class="flex items-center gap-4 pb-4 border-b border-base-200">
        <div class="avatar placeholder">
            <div class="w-16 h-16 rounded-full bg-primary/10 text-primary flex items-center justify-center">
                <span class="text-xl font-bold">{{ student.first_name|slice:":1" }}{{ student.last_name|slice:":1" }}</span>
            </div>
        </div>
        <div>
            <h3 class="text-lg font-bold">{{ student.full_name }}</h3>
            <p class="text-sm text-base-content/60">{{ student.admission_number }}</p>
            {% if student.current_class %}
            <span class="badge badge-ghost badge-sm mt-1">{{ student.current_class.name }}</span>
            {% endif %}
        </div>
    </div>

    <!-- Stats Summary -->
    <div class="grid grid-cols-5 gap-2">
        <div class="text-center p-2 rounded-lg bg-base-200">
            <div class="text-lg md:text-xl font-bold">{{ stats.total }}</div>
            <div class="text-[10px] md:text-xs text-base-content/60">Total</div>
        </div>
        <div class="text-center p-2 rounded-lg bg-success/10">
            <div class="text-lg md:text-xl font-bold text-success">{{ stats.present }}</div>
            <div class="text-[10px] md:text-xs text-base-content/60">Present</div>
        </div>
        <div class="text-center p-2 rounded-lg bg-error/10">
            <div class="text-lg md:text-xl font-bold text-error">{{ stats.absent }}</div>
            <div class="text-[10px] md:text-xs text-base-content/60">Absent</div>
        </div>
        <div class="text-center p-2 rounded-lg bg-warning/10">
            <div class="text-lg md:text-xl font-bold text-warning">{{ stats.late }}</div>
            <div class="text-[10px] md:text-xs text-base-content/60">Late</div>
        </div>
        <div class="text-center p-2 rounded-lg {% if stats.rate >= 80 %}bg-success/10{% elif stats.rate >= 60 %}bg-warning/10{% else %}bg-error/10{% endif %}">
            <div class="text-lg md:text-xl font-bold {% if stats.rate >= 80 %}text-success{% elif stats.rate >= 60 %}text-warning{% else %}text-error{% endif %}">
                {{ stats.rate }}%
            </div>
            <div class="text-[10px] md:text-xs text-base-content/60">Rate</div>
        </div>
    </div>

    <!-- Attendance Rate Bar -->
    <div class="w-full bg-base-200 rounded-full h-2.5 overflow-hidden">
        <div class="h-2.5 rounded-full transition-all duration-500 {% if stats.rate >= 80 %}bg-success{% elif stats.rate >= 60 %}bg-warning{% else %}bg-error{% endif %}"
             style="width: {{ stats.rate }}%"></div>
    </div>

    <!-- Attendance Calendar/History -->
    <div class="mt-4">
        <h4 class="font-semibold mb-3 flex items-center gap-2">
            <i class="fa-solid fa-calendar-days text-primary"></i>
            Attendance History
            <span class="text-xs text-base-content/50 font-normal">({{ date_from }} to {{ date_to }})</span>
        </h4>

        {% if attendance_data %}
        <!-- Mobile: Card Layout -->
        <div class="md:hidden space-y-2 max-h-64 overflow-y-auto">
            {% for record in attendance_data %}
            <div class="flex items-center justify-between p-3 rounded-lg border border-base-200
                        {% if record.status == 'P' %}bg-success/5{% elif record.status == 'A' %}bg-error/5{% elif record.status == 'L' %}bg-warning/5{% else %}bg-base-100{% endif %}">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-lg bg-base-200 flex flex-col items-center justify-center">
                        <span class="text-xs font-bold leading-none" id="day-{{ forloop.counter }}">--</span>
                        <span class="text-[10px] text-base-content/60" id="month-{{ forloop.counter }}">---</span>
                    </div>
                    <div>
                        <span class="text-sm font-medium" id="dayname-{{ forloop.counter }}">---</span>
                        {% if record.remarks %}
                        <p class="text-xs text-base-content/60">{{ record.remarks }}</p>
                        {% endif %}
                    </div>
                </div>
                {% if record.status == 'P' %}
                <span class="badge badge-success gap-1"><i class="fa-solid fa-check"></i> Present</span>
                {% elif record.status == 'A' %}
                <span class="badge badge-error gap-1"><i class="fa-solid fa-xmark"></i> Absent</span>
                {% elif record.status == 'L' %}
                <span class="badge badge-warning gap-1"><i class="fa-solid fa-clock"></i> Late</span>
                {% elif record.status == 'E' %}
                <span class="badge badge-info gap-1"><i class="fa-solid fa-calendar-check"></i> Excused</span>
                {% else %}
                <span class="badge badge-ghost">{{ record.status_display }}</span>
                {% endif %}
            </div>
            <script>
                (function() {
                    const d = new Date('{{ record.date }}');
                    document.getElementById('day-{{ forloop.counter }}').textContent = d.getDate();
                    document.getElementById('month-{{ forloop.counter }}').textContent = d.toLocaleDateString('en-US', { month: 'short' });
                    document.getElementById('dayname-{{ forloop.counter }}').textContent = d.toLocaleDateString('en-US', { weekday: 'long' });
                })();
            </script>
            {% endfor %}
        </div>

        <!-- Desktop: Table Layout -->
        <div class="hidden md:block overflow-x-auto max-h-64">
            <table class="table table-xs">
                <thead class="sticky top-0 bg-base-100">
                    <tr class="text-xs uppercase text-base-content/50">
                        <th>Date</th>
                        <th class="text-center">Status</th>
                        <th>Remarks</th>
                    </tr>
                </thead>
                <tbody>
                    {% for record in attendance_data %}
                    <tr class="hover {% if record.status == 'A' %}bg-error/5{% elif record.status == 'L' %}bg-warning/5{% endif %}">
                        <td class="font-mono text-sm">{{ record.date }}</td>
                        <td class="text-center">
                            {% if record.status == 'P' %}
                            <span class="badge badge-success badge-xs">Present</span>
                            {% elif record.status == 'A' %}
                            <span class="badge badge-error badge-xs">Absent</span>
                            {% elif record.status == 'L' %}
                            <span class="badge badge-warning badge-xs">Late</span>
                            {% elif record.status == 'E' %}
                            <span class="badge badge-info badge-xs">Excused</span>
                            {% else %}
                            <span class="badge badge-ghost badge-xs">{{ record.status_display }}</span>
                            {% endif %}
                        </td>
                        <td class="text-xs text-base-content/60">{{ record.remarks|default:"-" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Legend -->
        <div class="flex flex-wrap gap-3 mt-3 pt-3 border-t border-base-200">
            <div class="flex items-center gap-1.5 text-xs">
                <span class="w-3 h-3 rounded bg-success"></span>
                <span>Present</span>
            </div>
            <div class="flex items-center gap-1.5 text-xs">
                <span class="w-3 h-3 rounded bg-warning"></span>
                <span>Late</span>
            </div>
            <div class="flex items-center gap-1.5 text-xs">
                <span class="w-3 h-3 rounded bg-error"></span>
                <span>Absent</span>
            </div>
            <div class="flex items-center gap-1.5 text-xs">
                <span class="w-3 h-3 rounded bg-info"></span>
                <span>Excused</span>
            </div>
        </div>
        {% else %}
        <div class="text-center py-8 text-base-content/40">
            <i class="fa-solid fa-calendar-xmark text-3xl mb-2"></i>
            <p class="text-sm">No attendance records for this period</p>
        </div>
        {% endif %}
    </div>

    <!-- Guardian Contact -->
    {% if student.guardian_phone or student.guardian_email %}
    <div class="bg-base-200 rounded-lg p-3 mt-4">
        <h4 class="font-semibold text-sm mb-2">
            <i class="fa-solid fa-user-tie mr-1"></i> Guardian Contact
        </h4>
        <div class="flex flex-wrap gap-3 text-sm">
            {% if student.guardian_name %}
            <span class="text-base-content/70">{{ student.guardian_name }}</span>
            {% endif %}
            {% if student.guardian_phone %}
            <a href="tel:{{ student.guardian_phone }}" class="link link-primary">
                <i class="fa-solid fa-phone mr-1"></i>{{ student.guardian_phone }}
            </a>
            {% endif %}
            {% if student.guardian_email %}
            <a href="mailto:{{ student.guardian_email }}" class="link link-primary">
                <i class="fa-solid fa-envelope mr-1"></i>{{ student.guardian_email }}
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
