{% load core_tags %}

<h3 class="font-bold text-lg mb-4">
    {% if category %}Edit Category{% else %}Add Assessment Category{% endif %}
</h3>

{% if error %}
<div class="alert alert-error mb-3 py-2 text-sm">
    <i class="fa-solid fa-circle-exclamation"></i>
    <span>{{ error }}</span>
</div>
{% endif %}

<form method="post"
      hx-post="{% if category %}{% url 'gradebook:category_edit' category.pk %}{% else %}{% url 'gradebook:category_create' %}{% endif %}"
      hx-target="#modal-content">

    <div class="space-y-3">
        {% select_input "category_type" options=category_types value=category.category_type label="Type" size="sm" %}
        {% text_input "name" value=category.name label="Category Name" placeholder="e.g., Class Score" required=True size="sm" %}
        {% text_input "short_name" value=category.short_name label="Short Name" placeholder="e.g., CA" required=True size="sm" %}
        {% number_input "percentage" value=category.percentage|default:"30" label="Weight %" min=0 max=100 required=True size="sm" %}
        {% number_input "order" value=category.order|default:"0" label="Display Order" min=0 size="sm" %}
        <div class="grid grid-cols-2 gap-3">
            <div>{% number_input "min_assessments" value=category.min_assessments|default:"0" label="Min Assessments" min=0 size="sm" help_text="0 = no limit" %}</div>
            <div>{% number_input "max_assessments" value=category.max_assessments|default:"0" label="Max Assessments" min=0 size="sm" help_text="0 = no limit" %}</div>
        </div>

        {% if category %}
        {% checkbox_input "is_active" checked=category.is_active label="Active" size="sm" %}
        {% endif %}
    </div>

    <div class="modal-action">
        <button type="button" class="btn btn-sm btn-ghost" onclick="document.getElementById('modal_gradebook').close()">Cancel</button>
        <button type="submit" class="btn btn-sm btn-primary">
            {% if category %}Save{% else %}Add{% endif %}
        </button>
    </div>
</form>
