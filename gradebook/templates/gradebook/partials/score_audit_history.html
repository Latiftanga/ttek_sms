<h3 class="font-bold text-lg mb-4">
    <i class="fa-solid fa-clock-rotate-left text-primary"></i>
    Score History
</h3>

<div class="mb-4 p-3 bg-base-200 rounded-lg">
    <div class="text-sm">
        <span class="font-medium">Student:</span> {{ student.last_name }}, {{ student.first_name }}
    </div>
    <div class="text-sm">
        <span class="font-medium">Assignment:</span> {{ assignment.name }} ({{ assignment.subject.name }})
    </div>
</div>

{% if logs %}
<div class="overflow-x-auto">
    <table class="table table-sm">
        <thead>
            <tr class="text-xs uppercase bg-base-200">
                <th>Date/Time</th>
                <th>Action</th>
                <th>Old Value</th>
                <th>New Value</th>
                <th>Changed By</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr class="hover">
                <td class="text-xs">
                    {{ log.created_at|date:"M d, Y" }}<br>
                    <span class="text-base-content/60">{{ log.created_at|time:"H:i:s" }}</span>
                </td>
                <td>
                    {% if log.action == 'CREATE' %}
                    <span class="badge badge-success badge-sm">Created</span>
                    {% elif log.action == 'UPDATE' %}
                    <span class="badge badge-warning badge-sm">Updated</span>
                    {% elif log.action == 'DELETE' %}
                    <span class="badge badge-error badge-sm">Deleted</span>
                    {% endif %}
                </td>
                <td class="text-center">
                    {% if log.old_value is not None %}
                    {{ log.old_value }}
                    {% else %}
                    <span class="text-base-content/40">-</span>
                    {% endif %}
                </td>
                <td class="text-center">
                    {% if log.new_value is not None %}
                    {{ log.new_value }}
                    {% else %}
                    <span class="text-base-content/40">-</span>
                    {% endif %}
                </td>
                <td class="text-sm">
                    {% if log.user %}
                    {{ log.user.get_full_name|default:log.user.username }}
                    {% else %}
                    <span class="text-base-content/40">Unknown</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="text-center py-8 text-base-content/40">
    <i class="fa-solid fa-clock-rotate-left text-3xl mb-2"></i>
    <p class="text-sm">No change history found</p>
</div>
{% endif %}

<div class="modal-action">
    <button type="button" class="btn btn-ghost" onclick="modal_audit.close()">Close</button>
</div>
