{% if student_guardians %}
<div class="space-y-3">
    {% for sg in student_guardians %}
    <div class="flex items-center justify-between p-3 bg-base-200 rounded-lg">
        <div class="flex items-center gap-3">
            <div class="avatar placeholder">
                <div class="bg-primary text-primary-content rounded-full w-10 h-10 flex items-center justify-center">
                    <span class="text-sm">{{ sg.guardian.full_name|slice:":2"|upper }}</span>
                </div>
            </div>
            <div>
                <div class="flex items-center gap-2">
                    <span class="font-medium">{{ sg.guardian.full_name }}</span>
                    {% if sg.is_primary %}
                    <span class="badge badge-primary badge-sm">Primary</span>
                    {% endif %}
                    {% if sg.is_emergency_contact %}
                    <span class="badge badge-ghost badge-sm">Emergency</span>
                    {% endif %}
                </div>
                <div class="text-sm text-base-content/60">
                    {{ sg.get_relationship_display }} &bull; {{ sg.guardian.phone_number }}
                </div>
            </div>
        </div>
        <div class="flex items-center gap-2">
            <!-- Relationship dropdown -->
            <select class="select select-bordered select-sm"
                    hx-post="{% url 'students:student_update_guardian_relationship' student.pk sg.guardian.pk %}"
                    hx-target="#guardian-list"
                    hx-swap="innerHTML"
                    name="relationship">
                {% for value, label in relationship_choices %}
                <option value="{{ value }}" {% if sg.relationship == value %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>

            {% if not sg.is_primary %}
            <!-- Set as primary -->
            <button type="button"
                    class="btn btn-ghost btn-sm btn-circle"
                    title="Set as primary"
                    hx-post="{% url 'students:student_set_primary_guardian' student.pk sg.guardian.pk %}"
                    hx-target="#guardian-list"
                    hx-swap="innerHTML">
                <i class="fa-solid fa-star"></i>
            </button>
            {% endif %}

            <!-- Remove -->
            <button type="button"
                    class="btn btn-ghost btn-sm btn-circle text-error"
                    title="Remove guardian"
                    hx-post="{% url 'students:student_remove_guardian' student.pk sg.guardian.pk %}"
                    hx-target="#guardian-list"
                    hx-swap="innerHTML"
                    hx-confirm="Remove {{ sg.guardian.full_name }} as guardian?">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="text-center py-6 text-base-content/50">
    <i class="fa-solid fa-user-shield text-3xl mb-2"></i>
    <p class="text-sm">No guardians added yet</p>
</div>
{% endif %}
